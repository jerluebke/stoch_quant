\documentclass[11pt,a4paper]{scrartcl}
\usepackage{fontspec}
\usepackage{polyglossia}
    \setdefaultlanguage{english}
\usepackage{lmodern}
\usepackage{fixcmex}
\usepackage{csquotes}
\usepackage{enumitem}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{textcomp}
\usepackage{gensymb}
\usepackage{siunitx}
    \sisetup{range-units=brackets}
\usepackage{physics}
\usepackage{array}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{graphicx}
    \graphicspath{img}
\usepackage{tikz}
    \usetikzlibrary{calc,external}
    \tikzexternalize[prefix=extern/]
    \tikzexternaldisable
\usepackage{pgfplots}
    \pgfplotsset{%
        compat=1.15,
        table/search path={data},
    }
\usepackage[makeroom]{cancel}
\usepackage{todonotes}
\usepackage[%
    colorlinks=true, linkcolor=blue,
    % hidelinks
]{hyperref}


\setlength\parindent{0pt}


\newcommand{\tablehead}[1]{\multicolumn{1}{c}{#1}}
\newcommand*{\figref}[1]{(see fig.~\ref{#1})}
\newcommand{\eg}{e.\,g.}
\newcommand{\ie}{i.\,e.}
\newcommand{\action}{\ensuremath{\mathcal{S}}}
\newcommand{\SD}{\ensuremath{\mathcal{S}_{\mathrm{D}}}}
\newcommand{\xdoti}{\ensuremath{\dot{x}_i}}
\newcommand{\xdotj}{\ensuremath{\dot{x}_j}}
\newcommand{\xdotjm}{\ensuremath{\dot{x}_{j-1}}}
\newcommand{\deltaij}{\ensuremath{\delta_{ij}}}
\newcommand{\OverDeltaT}[1]{\ensuremath{\frac{#1}{\Delta t}}}
\newcommand{\DT}{\ensuremath{\mathrm{D}_t}}
\newcommand{\OverTwoDeltaT}[1]{\ensuremath{\frac{#1}{2\, \Delta t}}}
\newcommand{\xdotjp}{\ensuremath{\dot{x}_{j+1}}}
\newcommand{\avg}[1]{\langle#1\rangle}
\newcommand{\SE}{\mathcal{S}_{\mathrm{E}}}
\newcommand{\SEh}{\mathcal{S}_{\mathrm{E},h}}
\newcommand{\pathinth}[1]{\int\mathcal{D}[x]#1e^{-\SEh}}
\newcommand{\pathint}[1]{\int\mathcal{D}[x]#1e^{-\SE}}
\newcommand{\BigO}[1]{\mathcal{O}\left(#1\right)}
\DeclareMathOperator{\cov}{cov}


\title{Some equations related to \emph{Stochastic Quantization}}
\author{Jeremiah LÃ¼bke, Franz Wilfarth}
\date{\today}


\begin{document}
\maketitle

\section*{Discrete Derivative of the Action Functional}
Let us start by discretizing the action functional:
\begin{equation*}
    \mathcal{S}\left[x(t)\right] = \int\dd{t}L\left(x(t), \dot{x}(t)\right)
    \quad\longrightarrow\quad
    \SD\left(\{x_i\}\right) = \sum_i L\left(x_i, \xdoti\right)\Delta t
\end{equation*}
where $x(t) \longrightarrow x_i \equiv x(t_i)$ and $\dot{x}(t) \longrightarrow
\xdoti \equiv \OverTwoDeltaT{x_{i+1}-x_{i-1}}$. For convenience we write $L_i \equiv
L(x_i, \xdoti)$.\\

Now we compute the derivative:
\begin{equation*}
    \dv{\SD}{x_j} =\sum_i\dv{L_i}{x_j}\,\Delta t
    =\sum_i\left(\pdv{L_i}{x_i}\pdv{x_i}{x_j}+\pdv{L_i}{\xdoti}\pdv{\xdoti}{x_j}\right)
    \Delta t
\end{equation*}
with
\begin{equation*}
    \pdv{x_i}{x_j}=\pdv{x(t_i)}{x(t_j)}=\delta(t_i-t_j)\longrightarrow\OverDeltaT{\deltaij}
\end{equation*}
and
\begin{align*}
    \pdv{\xdoti}{x_j}=\pdv{\OverTwoDeltaT{x_{i+1}-x_{i-1}}}{x_j}
    =\OverTwoDeltaT{1}\left(\pdv{x_{i+1}}{x_j}-\pdv{x_{i-1}}{x_j}\right)
    =\OverTwoDeltaT{\delta(t_{i+1}-t_j)-\delta(t_{i-1}-t_j)}
    \longrightarrow\frac{\delta_{i+1,j}-\delta_{i-1,j}}{2\,(\Delta t)^2}.
\end{align*}
where we have used $\int\dd{t}\delta(t-s)\longrightarrow\sum\Delta{t}\frac{\delta_{t, s}}{\Delta{t}}$.\\

The $\delta$-s kill the sum, and we can write (pay attention to the indices):
\begin{align*}
    \dv{\SD}{x_j}&=\left[\OverDeltaT{1}\pdv{L_j}{x_j}+\frac{1}{2\,(\Delta{t})^2}
    \left(\pdv{L_{j-1}}{\xdotjm}-\pdv{L_{j+1}}{\xdotjp}\right)\right]\Delta{t}\\
    &=\pdv{L_j}{x_j}-\OverTwoDeltaT{1}\left(\pdv{L_{j+1}}{\xdotjp}-\pdv{L_{j-1}}{\xdotjm}\right)\\
    \implies\Aboxed{\dv{\SD}{x_j}&=\pdv{L_j}{x_j}-\DT\left(\pdv{L_{j}}{\xdotj}\right)}
\end{align*}
where $\DT(f_i)=\OverTwoDeltaT{f_{i+1}-f_{i-1}}$ is the discrete time derivation
operator.\\
This is exactly what we wanted to achieve.\\

For clarity, we make the transition back to the continuous description:
\begin{equation*}
    \dv{\SD}{x_j}\longrightarrow\fdv{\mathcal{S}[x]}{x}=\pdv{L}{x}-\dv{t}\pdv{L}{\dot{x}}
\end{equation*}
which is the well known \emph{Euler-Lagrange-Equation}.


\section*{Correlation Function}
Show:
\begin{equation*}
    \cov(x_0, x_l) \equiv \avg{x_0 x_l}-\avg{x_0}\avg{x_l}
    = \frac{\avg{x_l}_h-\avg{x_l}}{h}+\BigO{h}
\end{equation*}

Consider:
\begin{align*}
    \eval{\dv{\avg{x_l}_h}{h}}_{h=0} &=
    \eval{\dv{h}\frac{\pathinth{\,x_l\,}}{\pathinth{}}}_{h=0} \\ &=
    \eval{\frac{\left(\pathinth{\,x_l x_0\,}\right)\left(\pathinth{}\right)
    -\left(\pathinth{x_l}\right)\left(\pathinth{x_0}\right)}
    {\left(\pathinth{}\right)^2}}_{h=0} \\ &=
    \frac{\left(\pathint{\,x_0 x_l\,}\right)\left(\pathint{}\right)
    -\left(\pathint{x_l}\right)\left(\pathint{x_0}\right)}
    {\left(\pathint{}\right)^2} \\ &=
    \avg{x_0 x_l}-\avg{x_0}\avg{x_l} \tag{i}
\end{align*}
Taylor at $h=0$ (where $\avg{x_l}_0\equiv\avg{x_l}$):
\begin{equation*}
    \avg{x_l}_h=\avg{x_l}_0+\eval{\dv{\avg{x_l}_h}{h}}_{h=0}\,h+\BigO{h^2}
    \tag{ii}
\end{equation*}
\begin{equation*}
    \overset{(i),(ii)}{\implies}\eval{\dv{\avg{x_l}_h}{h}}_{h=0}
    =\boxed{\avg{x_0 x_l}-\avg{x_0}\avg{x_l}
    =\frac{\avg{x_l}_h-\avg{x_l}}{h}+\BigO{h}}
\end{equation*}


\section*{Implementation of modified Action}
Why the correspondance (see file \texttt{langevin\_solver.py}, line 145):
\begin{equation*}
    \SEh=\SE-h\,x_0 \iff \texttt{xh[0]+=h*dtau}
\end{equation*}

\emph{Solution}

\begin{equation*}
    \dv{\action_{\mathrm{D}, h}}{x_j}=\dv{\SD}{x_j}-h\,\delta_{0,j}
\end{equation*}
\todo{Context to Langevin equation}

\end{document}
