#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import numpy as np
import matplotlib.pyplot as plt


# DATA (np.random.seed(100), approx. 64000 steps)

grid = np.arange(0., 12.8, .1)

# long-term average
lta = np.array([
    -0.02497627, -0.01836915, -0.00917456, -0.00056501,  0.00573389,
     0.01566596,  0.02374718,  0.03191285,  0.04384134,  0.04136817,
     0.03394505,  0.01758984,  0.00199183, -0.00811967, -0.02126682,
    -0.032621  , -0.03908202, -0.04226145, -0.04185887, -0.04760299,
    -0.0485051 , -0.04250533, -0.03264525, -0.02370884, -0.01161609,
    -0.00038519,  0.01183628,  0.02900438,  0.04641374,  0.05986143,
     0.06804821,  0.07372657,  0.07962819,  0.08969337,  0.09637378,
     0.09796766,  0.10098283,  0.10712552,  0.11645636,  0.12634898,
     0.12735886,  0.12546791,  0.11605587,  0.10212246,  0.08049703,
     0.05710163,  0.03670007,  0.01358115, -0.00114686, -0.01647428,
    -0.02540787, -0.03235529, -0.03388988, -0.03586736, -0.04425476,
    -0.05015689, -0.05746712, -0.06981601, -0.07633554, -0.08592936,
    -0.09349308, -0.10401439, -0.11709685, -0.12090635, -0.11902534,
    -0.12281361, -0.1245453 , -0.12006775, -0.11868778, -0.11897473,
    -0.11195976, -0.09744836, -0.0805375 , -0.06318656, -0.04811959,
    -0.0255821 ,  0.00222721,  0.02293561,  0.03918872,  0.05802572,
     0.07531195,  0.08751716,  0.09298268,  0.09499693,  0.09898647,
     0.10272734,  0.10797227,  0.10900287,  0.11294723,  0.12485871,
     0.12880644,  0.14038419,  0.1539415 ,  0.16222059,  0.16488869,
     0.16625178,  0.16824009,  0.16676259,  0.15955973,  0.15173772,
     0.13620376,  0.11884223,  0.10141796,  0.08800818,  0.07307452,
     0.06181618,  0.04932896,  0.04134743,  0.0360955 ,  0.03479807,
     0.03239996,  0.04500692,  0.04751893,  0.048972  ,  0.05063913,
     0.04915328,  0.04893501,  0.0531454 ,  0.05385369,  0.04975871,
     0.04980062,  0.05027348,  0.06590032,  0.07681088,  0.08697031,
     0.08679976,  0.09516828,  0.09832911
])

# short-term average
sta = np.array([
     1.10395671,  1.14170646,  1.07889823,  1.21994206,  1.33095178,
     1.26534711,  1.11344812,  1.00384295,  0.87897318,  0.83040875,
     0.83318633,  0.97390267,  0.89954405,  0.87223537,  0.9368518 ,
     1.00567   ,  1.07281505,  1.17393139,  1.16517762,  1.03944766,
     0.90437178,  0.70785585,  0.61755178,  0.52459391,  0.41326687,
     0.61938975,  0.86717658,  1.06963958,  1.25060024,  1.23093402,
     1.07667498,  0.94308989,  0.89572355,  1.06711654,  1.12429612,
     1.1095076 ,  0.88097976,  0.67026496,  0.79624599,  1.0368796 ,
     1.15556831,  0.97037596,  0.78999079,  0.70798376,  0.79555224,
     0.70279032,  0.53560771,  0.49871249,  0.45884128,  0.67654481,
     0.57892947,  0.64399096,  0.67967172,  0.74678168,  0.76040006,
     0.77882095,  0.8938078 ,  0.88343064,  0.7801087 ,  0.76757555,
     0.78515956,  0.60577944,  0.55457409,  0.46335259,  0.11989926,
    -0.07308585, -0.27844232, -0.52043199, -0.65183895, -0.69609296,
    -0.60539303, -0.51524576, -0.50447192, -0.48440804, -0.65626431,
    -0.73838823, -0.77679479, -0.79437995, -0.71526249, -0.83580279,
    -0.95624554, -1.00386709, -0.96929003, -0.94531743, -1.10400595,
    -1.15248954, -1.18456571, -1.24359119, -1.21404533, -1.14225192,
    -1.07108353, -0.95248373, -0.71943282, -0.6759083 , -0.57354761,
    -0.50935618, -0.35448922, -0.2678253 , -0.31114849, -0.43351374,
    -0.35799866, -0.40502957, -0.453078  , -0.51700051, -0.50692579,
    -0.35728645, -0.23441213, -0.16307257, -0.10721131, -0.02947553,
    -0.19146971, -0.36757948, -0.52529828, -0.63931001, -0.66391877,
    -0.64069786, -0.5308493 , -0.5466836 , -0.43266854, -0.56193108,
    -0.53692059, -0.38555374, -0.27544212, -0.21931574, -0.19628264,
    -0.26501563, -0.46042989, -0.43058508
])



# PLOTTING

fig = plt.figure(figsize=(5, 3.75))

plt.hlines(y=[1., -1.], xmin=0., xmax=12.7, linestyle='--')
plt.hlines(y=0., xmin=0., xmax=12.7, linestyle=':')
plt.vlines(x=6.4, ymin=-1.4, ymax=1.4, colors='gray', linestyle=':')

plt.text(10., 1., 'Minimum', ha='left', va='center', bbox=dict(color='white'))
plt.text(10.,-1., 'Minimum', ha='left', va='center', bbox=dict(color='white'))
plt.text(10., 0., 'Maximum', ha='left', va='center', bbox=dict(color='white'))
plt.text(6.4, 1.1, 'sample', ha='center', va='center', rotation=90,
         bbox=dict(color='white'))

plt.plot(grid, lta, label='long-term average')
plt.plot(grid, sta, label='short-term average')

plt.xlabel('$t$')
plt.ylabel('$x$')
plt.legend(loc='lower left', handlelength=1.3, framealpha=1)

plt.xlim(0, 12.7)
plt.ylim(-1.4, 1.4)
plt.grid(False)
plt.xticks(np.arange(0, 12+1, 2), np.arange(0, 120+1, 20))
plt.tick_params(axis='both', direction='out', top=False, right=False)

plt.tight_layout()
plt.savefig('averages.pdf', dpi=300)
#  plt.show()


#  vim: set ff=unix tw=79 sw=4 ts=8 et ic ai : 
